## UDP (User Datagram Protocol)

전송계층의 프로토콜 중 하나로, 데이터그램 단위로 데이터를 송수신한다.
빠른 데이터 처리가 필요한 환경에서 사용된다.
이는 통신을 위한 연결을 수행하지않고, 최소한의 오류제어만 제공하기 때문이다.

따라서 신속하다는 장점이 있는 반면 데이터가 손실되거나, 순서가 뒤바껴서 도착할 수 있는 단점이 있다.

실시간 미디어 스트리밍 서비스, DNS, DHCP, HTTP/3.0과 같은 응용에서 사용된다.

### UDP 패킷 헤더 구조

![udp 패킷헤더](https://user-images.githubusercontent.com/55647436/225491764-4dd3d8ec-4a2a-499c-9534-ce596c1751df.png)

- source port, destionation port: 각각 송신, 수신지 포트
- length: 패킷 전체의 길이
- checksum: 오류제어를 위해 사용

각 필드는 2byte를 차지한다. 따라서 UDP 패킷헤더의 크기는 8byte(32bits)이다.

### 오류 제어

UDP는 흐름제어, 혼잡제어를 지원하지않지만 오류제어를 선택적으로 수행한다.
UDP는 이를 위해 Checksum을 이용하여, 데이터에 오류가 없는지 확인한다.

1. 송신측에서 전체 패킷에 대해 체크섬을 만들어서 전송한다.
2. 수신측에서 체크섬을 만들어 전송된 체크섬과 비교한다.
3. 데이터 이상이 발생했는지 판별한다.

### DNS이 UDP를 사용하는 이유

DNS는 UDP 뿐만 아니라 TCP를 이용해서도 구현이된다. TCP를 이용하면 데이터 안정성을 보장받을 수 있고, 비교적 큰 데이터를 주고받을 수 있다.

하지만 아래의 특징 때문에 UDP를 주로 사용한다.

- query와 response가 간단하여 많은 메모리 공간이 필요없다.
- 많은 사용자에게 빠르게 서비스하기위해, 커넥션 생성 및 유지 비용을 줄이는 것이 좋다.

**통신 중 데이터 손실이 발생하면 어떻게 될까?**

응용계층에서 timeout을 발생시켜 요청을 재전송하도록한다.

이는 UDP는 스스로 재전송을 하지 않기때문이다. 이런 문제를 개선하기 위해 상위 계층이 timer를 사용한다.

<!-- Checksum 계산 방식 -->
<!-- why DHCP, HTTP/3.0 are using UDP -->
