## Red-Black tree

노드에 색을 부여해서 트리의 균형을 유지하는 이진탐색트리이다. N개의 노드에 대한 탐색, 삽입, 삭제 시 항상 O(logN)의 시간복잡도를 제공하는 장점이 있다.

### 조건

Red-Black tree가 되기위해 아래의 조건을 만족해야한다.

1. 노드의 색상은 빨간색 또는 검정색
2. 루트노드와 이파리노드의 색상은 검정색
3. 연속된 2개의 빨간 노드 존재하지않음
4. 모든 이파리노드부터 루트노드까지의 경로 상의 검정색 노드 개수 모두 동일

### 삽입 연산

삽입할 위치인 null 노드를 찾고, 빨간 색상을 가진 새로운 노드를 삽입한다.
이후 루트노드로 거슬러 올라가면서 규칙을 만족시키기 위해 Restructing 또는 Recoloring을 수행한다.

- Restructing

세로운 노드(8)와 부모 노드(5)사이에 Double Red가 발생했다. 이때 부모의 형제노드 즉 삼촌노드(null)가 검정일 때는 Restructing을 적용해서 해결한다.

1. 삽입노드 - 부모노드 - 조상노드 중 중간값을 최상단으로 옮기고 나머지 노드를 재정렬한다.
2. 조상노드를 검정색으로 바꾸고 두 자식노드를 빨간색으로 변경한다.

| 초기 상태                                                                                                            | Restructing - 1                                                                                                      | Restructing - 2                                                                                                      |
| -------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| ![red-black7](https://user-images.githubusercontent.com/55647436/233248669-2071c67c-8ebc-49ad-a8c5-e6a2f83255fa.png) | ![red-black9](https://user-images.githubusercontent.com/55647436/233248675-de280576-91ac-4beb-829a-474c237c36cb.png) | ![red-black8](https://user-images.githubusercontent.com/55647436/233248673-62d59760-7788-47ab-9f78-c97453e2b6a1.png) |

- Recoloring

새로운 노드(7)와 부모 노드(5)사이에 Double Red가 발생했다. 동시에 삼촌노드(15)가 빨강색상일 때 Recoloring을 수행한다.

부모노드와 삼촌노드를 검정색으로 변환하고 그들의 부모노드를 빨강색으로 변환한다.
이때 만약 빨강색으로 변경된 부모노드가 루트노드라면 Red-Black tree 규칙에 따라 검정색으로 변경한다.

| 초기 상태                                                                                                            | Recoloring                                                                                                           |
| -------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| ![red-black4](https://user-images.githubusercontent.com/55647436/233133847-c377d0af-8fd8-488e-95a2-933310403d08.png) | ![red-black5](https://user-images.githubusercontent.com/55647436/233133852-15e8032b-df50-43df-973a-723320a05f0a.png) |

### 삭제 연산

이진탐색트리의 삭제와 동일한 방식으로 진행된다. 이후 Red-Black tree의 속성을 만족하기위해 추가 연산을 진행한다. 아래는 일부 경우에 대한 해결방법이며, 더 많은 경우의 수가 존재한다.

1. 빨간 색상의 노드 삭제

5를 나타내는 노드는 빨간 색상을 가진다. 이를 삭제하더라도 항상 트리의 속성을 만족한다.

| 초기 상태                                                                                                                   | 노드 삭제                                                                                                                   |
| --------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| ![red-black-delete5](https://user-images.githubusercontent.com/55647436/233284756-7b1aead3-3939-4cf6-8f0d-a64cf992bd82.png) | ![red-black-delete5](https://user-images.githubusercontent.com/55647436/233284868-48e3fe73-1913-4ea1-9898-d8e5fbe33834.png) |

2.  검정 색상의 노드 삭제

- 이중흑색노드가 발생하는 예

검정색 노드(7)를 제거했고, 그 자리에 검정색 노드(10)가 위치하게되면서 이중흑색노드(10)이 발생했다. 루트노드부터 모든 이파리까지 경로 상의 검정 노드의 개수가 일치하지 않게됐다. 주변 노드의 색상에 따라 해결방법이 다르겠지만, 아래와 같은 경우에는 이렇게 처리한다.
이중흑색을 부모로 옮기고, 형제노드를 빨간색으로 변경한다.
만약 부모노드가 루트노드이면 이중흑색을 검정색으로 변경한다. 그렇지않으면 속성을 만족시키기위해 상황에 맞는 연산을 계속 수행한다.

| 초기 상태                                                                                                                   | 노드 삭제                                                                                                                   | 색상 변환                                                                                                                   |
| --------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| ![red-black-delete4](https://user-images.githubusercontent.com/55647436/233283396-7816c3ba-7dd7-4d8d-a087-2f7b0b4a5ef1.png) | ![red-black-delete5](https://user-images.githubusercontent.com/55647436/233284217-67abfff1-dead-4846-ae8d-69d2fc0faec1.png) | ![red-black-delete6](https://user-images.githubusercontent.com/55647436/233283570-77be0619-1bbb-48f7-aac6-906247895542.png) |
